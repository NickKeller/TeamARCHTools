<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/bootstraphacks.css">
  <link rel="stylesheet" href="css/bootstrap-slider.min.css">
  <link rel="stylesheet" href="css/archtools.css">

  <script src="js/jquery-3.1.1.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/bootstrap-slider.min.js"></script>
  <script src="js/Chart.min.js"></script>
  <script src="js/dsc.js"></script>
  <script src="js/dsc_charts.js"></script>
  <script src="js/loader.js"></script>
  <script src="js/raphael-2.1.4.min.js"></script>
</head>
<body>

<div class="container">
    <div class="row">
        <h2 id="title"></h2>
    </div>
    <div class="row">
        <div class="col-lg-6">
            <h3>Questions</h3>
            <div class="panel-group" id="accordion">

                <div id="question1" class="panel panel-default collapse">
                    <div class="panel-heading" data-toggle="collapse" data-parent="#accordion" href="#collapse1">
                        <h4 class="panel-title">
                            <a>Circumcised</a>
                        </h4>
                    </div>
                    <div id="collapse1" class="panel-collapse collapse" data-parent="#accordion">
                        <div class="panel-body">
                            <div id="question1Text"></div>
                            <br/>
                            <!-- Radio Button answers -->
                            <div class="answer1 btn-group" data-toggle="buttons">
                                <label id="answer11" class="btn btn-primary">
                                    <input type="radio" value="0"> Yes
                                </label>
                                <label id="answer12" class="btn btn-primary">
                                    <input type="radio" value="1"> No
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="question2" class="panel panel-default collapse">
                    <div class="panel-heading" data-toggle="collapse" data-parent="#accordion" href="#collapse2">
                        <h4 class="panel-title">
                            <a>PreP Use</a>
                        </h4>
                    </div>
                    <div id="collapse2" class="panel-collapse collapse" data-parent="#accordion">
                        <div class="panel-body">
                            <div id="question2Text"></div>
                            <br/>
                            <!-- Radio Button answers -->
                            <div class="answer2 btn-group" data-toggle="buttons">
                                <label id="answer21" class="btn btn-primary">
                                    <input type="radio" value="0"> Yes
                                </label>
                                <label id="answer22" class="btn btn-primary">
                                    <input type="radio" value="1"> No
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="question3" class="panel panel-default collapse">
                    <div class="panel-heading" data-toggle="collapse" data-parent="#accordion" href="#collapse3">
                        <h4 class="panel-title">
                            <a>Gender of HIV Partner</a>
                        </h4>
                    </div>
                    <div id="collapse3" class="panel-collapse collapse" data-parent="#accordion">
                        <div class="panel-body">
                            <div id="question3Text"></div>
                            <br/>
                            <!-- Radio Button answers -->
                            <div class="answer3 btn-group" data-toggle="buttons">
                                <label id="answer31" class="btn btn-primary">
                                    <input type="radio" value="0"> Male
                                </label>
                                <label id="answer32" class="btn btn-primary">
                                    <input type="radio" value="1"> Female
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="question4" class="panel panel-default collapse">
                    <div class="panel-heading" data-toggle="collapse" data-parent="#accordion" href="#collapse4">
                        <h4 class="panel-title">
                            <a>ART Use</a>
                        </h4>
                    </div>
                    <div id="collapse4" class="panel-collapse collapse" data-parent="#accordion">
                        <div class="panel-body">
                            <div id="question4Text"></div>
                            <br/>
                            <!-- Radio Button answers -->
                            <div class="answer4 btn-group" data-toggle="buttons">
                                <label id="answer41" class="btn btn-primary">
                                    <input type="radio" value="0"> Yes
                                </label>
                                <label id="answer42" class="btn btn-primary">
                                    <input type="radio" value="1"> No
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="question5" class="panel panel-default collapse">
                    <div class="panel-heading" data-toggle="collapse" data-parent="#accordion" href="#collapse5">
                        <h4 class="panel-title">
                            <a>Insertive Vaginal Sex</a>
                        </h4>
                    </div>
                    <div id="collapse5" class="panel-collapse collapse" data-parent="#accordion">
                        <div class="panel-body">
                            <div id="question5Text"></div>
                            <br/>
                            <div class="answersSection">
                                <input class="answer5 slider" type="text" data-slider-min="0" data-slider-max="50" data-slider-step="1" data-slider-value="0" data-slider-tooltip="hide"/>
                                <span><span id="answer5slider">0</span></span>
                            </div>
                            <div id="question6Text"></div>
                            <br/>
                            <div class="answersSection">
                                <input class="answer6 slider" type="text" data-slider-min="0" data-slider-max="100" data-slider-step="1" data-slider-value="0" data-slider-tooltip="hide"/>
                                <span><span id="answer6slider">0</span></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="question7" class="panel panel-default collapse">
                    <div class="panel-heading" data-toggle="collapse" data-parent="#accordion" href="#collapse7">
                        <h4 class="panel-title">
                            <a>Receptive Vaginal Sex</a>
                        </h4>
                    </div>
                    <div id="collapse7" class="panel-collapse collapse" data-parent="#accordion">
                        <div class="panel-body">
                            <div id="question7Text"></div>
                            <br/>
                            <div class="answersSection">
                                <input class="answer7 slider" type="text" data-slider-min="0" data-slider-max="50" data-slider-step="1" data-slider-value="0" data-slider-tooltip="hide"/>
                                <span><span id="answer7slider">0</span></span>
                            </div>
                            <div id="question8Text"></div>
                            <br/>
                            <div class="answersSection">
                                <input class="answer8 slider" type="text" data-slider-min="0" data-slider-max="100" data-slider-step="1" data-slider-value="0" data-slider-tooltip="hide"/>
                                <span><span id="answer8slider">0</span></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="question9" class="panel panel-default collapse">
                    <div class="panel-heading" data-toggle="collapse" data-parent="#accordion" href="#collapse9">
                        <h4 class="panel-title">
                            <a>Insertive Anal Sex</a>
                        </h4>
                    </div>
                    <div id="collapse9" class="panel-collapse collapse" data-parent="#accordion">
                        <div class="panel-body">
                            <div id="question9Text"></div>
                            <br/>
                            <div class="answersSection">
                                <input class="answer9 slider" type="text" data-slider-min="0" data-slider-max="50" data-slider-step="1" data-slider-value="0" data-slider-tooltip="hide"/>
                                <span><span id="answer9slider">0</span></span>
                            </div>
                            <div id="question10Text"></div>
                            <br/>
                            <div class="answersSection">
                                <input class="answer10 slider" type="text" data-slider-min="0" data-slider-max="100" data-slider-step="1" data-slider-value="0" data-slider-tooltip="hide"/>
                                <span><span id="answer10slider">0</span></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="question11" class="panel panel-default collapse">
                    <div class="panel-heading" data-toggle="collapse" data-parent="#accordion" href="#collapse11">
                        <h4 class="panel-title">
                            <a>Receptive Anal Sex</a>
                        </h4>
                    </div>
                    <div id="collapse11" class="panel-collapse collapse" data-parent="#accordion">
                        <div class="panel-body">
                            <div id="question11Text"></div>
                            <br/>
                            <div class="answersSection">
                                <input class="answer11 slider" type="text" data-slider-min="0" data-slider-max="50" data-slider-step="1" data-slider-value="0" data-slider-tooltip="hide"/>
                                <span><span id="answer11slider">0</span></span>
                            </div>
                            <div id="question12Text"></div>
                            <br/>
                            <div class="answersSection">
                                <input class="answer12 slider" type="text" data-slider-min="0" data-slider-max="100" data-slider-step="1" data-slider-value="0" data-slider-tooltip="hide"/>
                                <span><span id="answer12slider">0</span></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="question13" class="panel panel-default collapse">
                    <div class="panel-heading" data-toggle="collapse" data-parent="#accordion" href="#collapse13">
                        <h4 class="panel-title">
                            <a>Giving Oral Sex</a>
                        </h4>
                    </div>
                    <div id="collapse13" class="panel-collapse collapse" data-parent="#accordion">
                            <div class="panel-body">
                            <div id="question13Text"></div>
                            <br/>
                            <div class="answersSection">
                                <input class="answer13 slider" type="text" data-slider-min="0" data-slider-max="50" data-slider-step="1" data-slider-value="0" data-slider-tooltip="hide"/>
                                <span><span id="answer13slider">0</span></span>
                            </div>
                            <div id="question14Text"></div>
                            <br/>
                            <div class="answersSection">
                                <input class="answer14 slider" type="text" data-slider-min="0" data-slider-max="100" data-slider-step="1" data-slider-value="0" data-slider-tooltip="hide"/>
                                <span><span id="answer14slider">0</span></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="question15" class="panel panel-default collapse">
                    <div class="panel-heading" data-toggle="collapse" data-parent="#accordion" href="#collapse15">
                        <h4 class="panel-title">
                            <a>Receiving Oral Sex</a>
                        </h4>
                    </div>
                    <div id="collapse15" class="panel-collapse collapse" data-parent="#accordion">
                            <div class="panel-body">
                            <div id="question15Text"></div>
                            <br/>
                            <div class="answersSection">
                                <input class="answer15 slider" type="text" data-slider-min="0" data-slider-max="50" data-slider-step="1" data-slider-value="0" data-slider-tooltip="hide"/>
                                <span><span id="answer15slider">0</span></span>
                            </div>
                            <div id="question16Text"></div>
                            <br/>
                            <div class="answersSection">
                                <input class="answer16 slider" type="text" data-slider-min="0" data-slider-max="100" data-slider-step="1" data-slider-value="0" data-slider-tooltip="hide"/>
                                <span><span id="answer16slider">0</span></span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <div class="col-lg-6">
            <div class="row text-center">
                <h3>Results and Recommendations</h3>
            </div>
            <div class="row">
                <div class="col-lg-10 col-lg-offset-1 well">
                    <div class="row">
                        <h3>Chances of contracting HIV from your partner:</h3>
                        <table class="table table-condensed table-striped table-bordered">
                            <tbody>
                                <tr>
                                    <td>Per Month</td>
                                    <td id="monthper">0.0%</td>
                                    <td>OR</td>
                                    <td id="monthodds">1 in 9727</td>
                                </tr>
                                <tr>
                                    <td>Per Year</td>
                                    <td id="yearper">0.0%</td>
                                    <td>OR</td>
                                    <td id="yearodds">1 in 9727</td>
                                </tr>
                                <tr>
                                    <td id>In 10 years</td>
                                    <td id="10yearper">0.0%</td>
                                    <td>OR</td>
                                    <td id="10yearodds">1 in 9727</td>
                                </tr>
                                <tr>
                                    <td>In 25 years</td>
                                    <td id="25yearper">0.0%</td>
                                    <td>OR</td>
                                    <td id="25yearodds">1 in 9727</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="col-lg-10 col-lg-offset-1 well">
                    <h3>How much your specific sexual acts contribute to your risk of contracting HIV</h3>
                    <canvas id="actChart" class="img-responsive pie"></canvas>
                </div>
                <div class="col-lg-10 col-lg-offset-1 well">
                    <h3>Contributions to chances of contracting HIV by condom use</h3>
                    <canvas id="condomChart" class="img-responsive pie"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

</body>

<script type="text/javascript">

    $(document).ready(function(){
        dscSetup();
    });

    function dscSetup(){
        //loads the json from the file, then sets the questions on the page
        $.getJSON("ARCH-TOOLS.json", setDSCPage);
        updateStats();
    }

    function setDSCPage(json){
        //alert("Set page");
        var dscData = json.tests.DSC;
        $("#title").html(dscData.name);
        $("#finish").collapse("hide");
        //loop through the questions and set the text
        for(var index in dscData.questions){
            var question = dscData.questions[index];
            var text = question["text"];
            var num = question["number"];
            //set the question text
            $("#question" + num + "Text").html(text);
            $("#question" + num).collapse({toggle:false});
        }

        //show question 1
        $("#question1").collapse("show");
        $("#collapse1").collapse("show");

        $("#answer11").on("click", function(){
            UpdateCircumsizeRatios(true);
            $("#question2").collapse("show");
        });

        $("#answer12").on("click", function(){
            UpdateCircumsizeRatios(false);
            $("#question2").collapse("show");
        });

        $("#answer21").on("click", function(){
            UpdatePrepRatios(true);
            $("#question3").collapse("show");
        });

        $("#answer22").on("click", function(){
            UpdatePrepRatios(false);
            $("#question3").collapse("show");
        });

        $("#answer31").on("click", function(){
            UpdateGenderRatios(true);
            $("#question4").collapse("show");
        });

        $("#answer32").on("click", function(){
            UpdateGenderRatios(false);
            $("#question4").collapse("show");
        });

        $("#answer41").on("click", function(){
            UpdateArtRatios(true);
            $("#question5").collapse("show");
        });

        $("#answer42").on("click", function(){
            UpdateArtRatios(false);
            $("#question5").collapse("show");
        });

        $(".answer5").on("change",function(){
            tPM = $(".answer5").attr("value");
            pCU = $(".answer6").attr("value");

            calcInsertVagUnprotectedRiskFactor(tPM, pCU);
            calcInsertVagProtectedRiskFactor(tPM, pCU);
        });

        $(".answer5").on("slide", function(slideEvt) {
            var out;
            if (slideEvt.value == 50){
                out = '50 or more';
            }
            else {
                out = slideEvt.value
            }
            $("#answer5slider").text(out);
        });

        $(".answer6").on("change",function(){
            tPM = $(".answer5").attr("value");
            pCU = $(".answer6").attr("value");

            calcInsertVagUnprotectedRiskFactor(tPM, pCU);
            calcInsertVagProtectedRiskFactor(tPM, pCU);

            $("#question7").collapse("show");
        });

        $(".answer6").on("slide", function(slideEvt) {
            var out;
            if (slideEvt.value == 100){
                out = '100%';
            }
            else {
                out = slideEvt.value + "%"
            }
            $("#answer6slider").text(out);
        });

        $(".answer7").on("change",function(){
            tPM = $(".answer7").attr("value");
            pCU = $(".answer8").attr("value");

            calcReceptiveVagUnprotectedRiskFactor(tPM, pCU);
            calcReceptiveVagProtectedRiskFactor(tPM, pCU);
        });

        $(".answer7").on("slide", function(slideEvt) {
            var out;
            if (slideEvt.value == 50){
                out = '50 or more';
            }
            else {
                out = slideEvt.value
            }
            $("#answer7slider").text(out);
        });

        $(".answer8").on("change",function(){
            tPM = $(".answer7").attr("value");
            pCU = $(".answer8").attr("value");

            calcReceptiveVagUnprotectedRiskFactor(tPM, pCU);
            calcReceptiveVagProtectedRiskFactor(tPM, pCU);

            $("#question9").collapse("show");
        });

        $(".answer8").on("slide", function(slideEvt) {
            var out;
            if (slideEvt.value == 100){
                out = '100 or more';
            }
            else {
                out = slideEvt.value
            }
            $("#answer8slider").text(out);
        });

        $(".answer9").on("change",function(){
            tPM = $(".answer9").attr("value");
            pCU = $(".answer10").attr("value");

            calcInsertAnalUnprotectedRiskFactor(tPM, pCU);
            calcInsertAnalProtectedRiskFactor(tPM, pCU);
        });

        $(".answer9").on("slide", function(slideEvt) {
            var out;
            if (slideEvt.value == 50){
                out = '50 or more';
            }
            else {
                out = slideEvt.value
            }
            $("#answer9slider").text(out);
        });

        $(".answer10").on("change",function(){
            tPM = $(".answer9").attr("value");
            pCU = $(".answer10").attr("value");

            calcInsertAnalUnprotectedRiskFactor(tPM, pCU);
            calcInsertAnalProtectedRiskFactor(tPM, pCU);

            $("#question11").collapse("show");
        });

        $(".answer10").on("slide", function(slideEvt) {
            var out;
            if (slideEvt.value == 100){
                out = '100 or more';
            }
            else {
                out = slideEvt.value
            }
            $("#answer10slider").text(out);
        });

        $(".answer11").on("change",function(){
            tPM = $(".answer11").attr("value");
            pCU = $(".answer12").attr("value");

            calcReceptiveAnalUnprotectedRiskFactor(tPM, pCU);
            calcReceptiveAnalProtectedRiskFactor(tPM, pCU);
        });

        $(".answer11").on("slide", function(slideEvt) {
            var out;
            if (slideEvt.value == 50){
                out = '50 or more';
            }
            else {
                out = slideEvt.value
            }
            $("#answer11slider").text(out);
        });

        $(".answer12").on("change",function(){
            tPM = $(".answer11").attr("value");
            pCU = $(".answer12").attr("value");

            calcReceptiveAnalUnprotectedRiskFactor(tPM, pCU);
            calcReceptiveAnalProtectedRiskFactor(tPM, pCU);

            $("#question13").collapse("show");
        });

        $(".answer12").on("slide", function(slideEvt) {
            var out;
            if (slideEvt.value == 100){
                out = '100 or more';
            }
            else {
                out = slideEvt.value
            }
            $("#answer12slider").text(out);
        });

        $(".answer13").on("change",function(){
            tPM = $(".answer13").attr("value");
            pCU = $(".answer14").attr("value");

            calcGiveOralUnprotectedRiskFactor(tPM, pCU);
            calcGiveOralProtectedRiskFactor(tPM, pCU);
        });

        $(".answer13").on("slide", function(slideEvt) {
            var out;
            if (slideEvt.value == 50){
                out = '50 or more';
            }
            else {
                out = slideEvt.value
            }
            $("#answer13slider").text(out);
        });

        $(".answer14").on("change",function(){
            tPM = $(".answer13").attr("value");
            pCU = $(".answer14").attr("value");

            calcGiveOralUnprotectedRiskFactor(tPM, pCU);
            calcGiveOralProtectedRiskFactor(tPM, pCU);

            $("#question15").collapse("show");
        });

        $(".answer14").on("slide", function(slideEvt) {
            var out;
            if (slideEvt.value == 100){
                out = '100 or more';
            }
            else {
                out = slideEvt.value
            }
            $("#answer14slider").text(out);
        });

        $(".answer15").on("change",function(){
            tPM = $(".answer15").attr("value");
            pCU = $(".answer16").attr("value");

            calcReceiveOralUnprotectedRiskFactor(tPM, pCU);
            calcReceiveOralProtectedRiskFactor(tPM, pCU);
        });

        $(".answer15").on("slide", function(slideEvt) {
            var out;
            if (slideEvt.value == 50){
                out = '50 or more';
            }
            else {
                out = slideEvt.value
            }
            $("#answer15slider").text(out);
        });

        $(".answer16").on("change",function(){
            tPM = $(".answer15").attr("value");
            pCU = $(".answer16").attr("value");

            calcReceiveOralUnprotectedRiskFactor(tPM, pCU);
            calcReceiveOralProtectedRiskFactor(tPM, pCU);
        });

        $(".answer16").on("slide", function(slideEvt) {
            var out;
            if (slideEvt.value == 100){
                out = '100 or more';
            }
            else {
                out = slideEvt.value
            }
            $("#answer16slider").text(out);
        });




        setupSliders();

    }

    function setupSliders() {

        $('.answer5').slider({
            formatter: function(value) {
                if(value == 50) {
                    return '50 or more'
                }
                return value;
            }
        })
        $('.answer6').slider({
            formatter: function(value) {
                if(value == 100) {
                    return '100 or more'
                }
                return value;
            }
        })
        $('.answer7').slider({
            formatter: function(value) {
                if(value == 50) {
                    return '50 or more'
                }
                return value;
            }
        })
        $('.answer8').slider({
            formatter: function(value) {
                if(value == 100) {
                    return '100 or more'
                }
                return value;
            }
        })
        $('.answer9').slider({
            formatter: function(value) {
                if(value == 50) {
                    return '50 or more'
                }
                return value;
            }
        })
        $('.answer10').slider({
            formatter: function(value) {
                if(value == 100) {
                    return '100 or more'
                }
                return value;
            }
        })
        $('.answer11').slider({
            formatter: function(value) {
                if(value == 50) {
                    return '50 or more'
                }
                return value;
            }
        })
        $('.answer12').slider({
            formatter: function(value) {
                if(value == 100) {
                    return '100 or more'
                }
                return value;
            }
        })
        $('.answer13').slider({
            formatter: function(value) {
                if(value == 50) {
                    return '50 or more'
                }
                return value;
            }
        })
        $('.answer14').slider({
            formatter: function(value) {
                if(value == 100) {
                    return '100 or more'
                }
                return value;
            }
        })
        $('.answer15').slider({
            formatter: function(value) {
                if(value == 50) {
                    return '50 or more'
                }
                return value;
            }
        })
        $('.answer16').slider({
            formatter: function(value) {
                if(value == 100) {
                    return '100 or more'
                }
                return value;
            }
        })

    }



</script>
</html>
